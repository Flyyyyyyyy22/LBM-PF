clc
clear all
syms s0 s1 s2 s3 s4 s5 s6 s7 s8 g0 g1 g2 g3 g4 g5 g6 g7 g8

M = [[ 1,  1,  1,  1,  1,  1,  1,  1,  1];
    [-4, -1, -1, -1, -1,  2,  2,  2,  2];
    [ 4, -2, -2, -2, -2,  1,  1,  1,  1];
    [ 0,  1,  0, -1,  0,  1, -1, -1,  1];
    [ 0, -2,  0,  2,  0,  1, -1, -1,  1];
    [ 0,  0,  1,  0, -1,  1,  1, -1, -1];
    [ 0,  0, -2,  0,  2,  1,  1, -1, -1];
    [ 0,  1, -1,  1, -1,  0,  0,  0,  0];
    [ 0,  0,  0,  0,  0,  1, -1,  1, -1]];
M_inverse =[[4,   -4,   4,   0,	 0,	 0,	 0,	 0,	 0]
    [4,   -1,  -2,   6,  -6,	 0,	 0,	 9,	 0]
    [4,   -1,  -2,   0,	 0,	 6,	-6,	-9,	 0]
    [4,   -1,  -2,  -6,	 6,	 0,	 0,	 9,	 0]
    [4,   -1,  -2,   0,	 0,	-6,	 6,	-9,	 0]
    [4,    2,   1,   6,   3,	 6,	 3,	 0,	 9]
    [4,    2,   1,  -6,  -3,	 6,	 3,	 0,	-9]
    [4,    2,   1,  -6,  -3,	-6,	-3,	 0,	 9]
    [4,    2,   1,   6,	 3,	-6,	-3,	 0,	-9]]/36;
S_hat = diag([0,s1,s2,0,s4,0,s6,s7,s8]);

G=[g0;g1;g2;g3;g4;g5;g6;g7;g8];
-M_inverse*S_hat*M
%*G